### 分词调研总结

一、这次分词调研的不足：

#### 代码规范问题：

（1）=和+的空格问题
（2）def的空行问题
（3）不必要的备注和print
（4）尽量复写代码，封装函数，语句段不要重复，尽量写在一起
（5）命名注意动词加名词或者动词为主
（6）import的时候分组，标准库和第三方库分开
先import再 from*import，组内按照字母a-z排序

（7）一行不超过120字符，一个def不超过六十行

（8）统一用单引号和双引号

#### IDE

（1）pycharm的快捷键

- Ctrl + Shift + +：展开所有的代码块；
- Ctrl + Shift + -：收缩所有的代码块；
- ctrl + R  替换
- ctrl+shift+U大小写替换
- alt+insert新建py文件
- f6移动py文件
- f5复制py文件
- ctrl+tab替换
- Ctrl + W	选中增加的代码块
- Alt + Insert	自动生成代码新建一个py文件

#### python3方面

1. python3的函数不熟悉，比如assert的提前判断
   lambda的 filter flush，以及字典操作，

   sum（dict.values()）可以对字典的值直接相加

   分母+1e-10可以防止分母为零报错。

   import prettytable as pt 可以将结果以表格形式输出

   要读取文件的时候可以把路径组存进列表当中，避免代码的冗长

2. 文件写入过程没有注意时间复杂度，比如分词时候读文件和写文件同时进行
   先进行写，再读。而且文件写入数据时，数据先存入缓存，缓存满再进行写入，
   当最后一条数据存入缓存时候，缓存还没满，那么就会跳过这个数据不写入文件，
   导致读取人工分词结果获得的行数与算法分词文件获得的行数不同，因为算法分词是
   边读边写,写入f.flush()可以让每次写入数据都清空缓存

3. 常用函数time.time()

   round(n,3)

   os.path.splitext(path)将路径和后缀分开

#### 分词方面

1. 指标 qps = 总分词时间 / 语料包含的句子数 ,

   召回 = 算法和人工分词的词语交集 / 人工分词数  

   精度 = 算算法和人工分词的词语交集 /  算法分词数

   平均分词数越少，qps越高

   每次的qps都会有变化，**语料库越大越稳定**，越符合真实的速度

   #### “ 把语料的句子存入到列表中再进行分词，

   #### 比从文本中一句句提取出来分词速率要快 ”

   qps和分词条数和句子长度有关

1. 

2. 百度api的qps对于非免费用户在速度和准确率等指标都有限制
   测试的时候要用延时time.sleep(秒数) 推迟调用线程的运行，而且在对应的aipnlp的库文件里面
   设置忽略部分的编码错误

3. jieba分词是采用延时加载，每次启动分词时候需要从文件中读取模型

   jieba分词每次启动时，做了2件事情：

   - 加载结巴自身的默认词库
   - 将默认词库模型 加载到本机缓存，之后每次都从本地缓存中去加载默认词库 缓存文件： jieba.cache

   3. thulac分词后自动用空格进行分割，如果再加入其他分隔符会比较麻烦，

      之后要了解清楚各类分词工具的分词结果。直接把空格替换成=

#### 语料方面

1. 来自非正式场景的语料，包含很多特殊符号除了表情和一些反斜杠和斜杠等，导致在分词的时候
   不能选用传统的斜杠对词语进行分割，要选用“=”或者语料中未来也不可能会出现的字符。
2. 可能在爬取文案时解析xml字符串的过程中出现一些在末尾的/u200b不可见字符串，无法用正常的
   strip和replace空格来处理。要打印出分割语料的列表进行查看。
3. 百度api的分词输入需要限制为可用gbk进行编码的字符串，但是语料中会包含某些不可以用gbk编码
   的字符或者字节，这时候要到aipnlp的库文件中对这些小部分的编码报错进行忽略，因为它们通常不包含
   有用的信息。
4. 语料在分词之前是需要进行大写转小写【.lower()】，繁体转简体【snownlp包自带的繁转简， SnowNLP(u'xx')】和去除首尾换行符【.strip()】的预处理的。
   特殊符号预处理：https://blog.csdn.net/u010454729/article/details/88371102
5. emoji的表情，python有对应的库可以把表情转换成Unicode编码，直接用正则去除，可留可不留

#### 速度方面：

1. 这次的调研耗费的时间太久，部分问题总想靠着自己的方法解决，但之后可以及时和川哥沟通。
2. 没及时看钉钉导致接受信息不及时，之后一定要置顶钉钉界面

